define(["./when-208fe5b0","./Cartesian2-b4b7b0b3","./ArcType-dc1c5aee","./Transforms-73e77b72","./Color-a612ab18","./ComponentDatatype-2da3a966","./Check-5e798bbf","./GeometryAttribute-b541caa6","./GeometryAttributes-b0b294d8","./IndexDatatype-3bc916b1","./Math-8386669c","./PolylinePipeline-b7eedbaf","./RuntimeError-7f634f5d","./WebGLConstants-5e2a49ab","./EllipsoidGeodesic-92f0d3cc","./EllipsoidRhumbLine-73a4e3eb","./IntersectionTests-40db2afa","./Plane-b91bfb59"],(function(e,o,t,r,a,l,i,n,s,p,d,y,c,f,u,h,C,b){"use strict";function T(r){var l=(r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT)).positions,i=r.colors,n=e.defaultValue(r.colorsPerVertex,!1);this._positions=l,this._colors=i,this._colorsPerVertex=n,this._arcType=e.defaultValue(r.arcType,t.ArcType.GEODESIC),this._granularity=e.defaultValue(r.granularity,d.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=e.defaultValue(r.ellipsoid,o.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry",l=1+l.length*o.Cartesian3.packedLength,l+=e.defined(i)?1+i.length*a.Color.packedLength:1,this.packedLength=l+o.Ellipsoid.packedLength+3}T.pack=function(t,r,l){var i;l=e.defaultValue(l,0);var n=t._positions,s=n.length;for(r[l++]=s,i=0;i<s;++i,l+=o.Cartesian3.packedLength)o.Cartesian3.pack(n[i],r,l);var p=t._colors;s=e.defined(p)?p.length:0;for(r[l++]=s,i=0;i<s;++i,l+=a.Color.packedLength)a.Color.pack(p[i],r,l);return o.Ellipsoid.pack(t._ellipsoid,r,l),l+=o.Ellipsoid.packedLength,r[l++]=t._colorsPerVertex?1:0,r[l++]=t._arcType,r[l]=t._granularity,r},T.unpack=function(t,r,l){r=e.defaultValue(r,0);for(var i=t[r++],n=new Array(i),s=0;s<i;++s,r+=o.Cartesian3.packedLength)n[s]=o.Cartesian3.unpack(t,r);var p=0<(i=t[r++])?new Array(i):void 0;for(s=0;s<i;++s,r+=a.Color.packedLength)p[s]=a.Color.unpack(t,r);var d=o.Ellipsoid.unpack(t,r);r+=o.Ellipsoid.packedLength;var y=1===t[r++],c=t[r++],f=t[r];return e.defined(l)?(l._positions=n,l._colors=p,l._ellipsoid=d,l._colorsPerVertex=y,l._arcType=c,l._granularity=f,l):new T({positions:n,colors:p,ellipsoid:d,colorsPerVertex:y,arcType:c,granularity:f})};var g=new Array(2),m=new Array(2),P={positions:g,height:m,ellipsoid:void 0,minDistance:void 0,granularity:void 0};return T.createGeometry=function(i){var c=i._positions,f=i._colors,u=i._colorsPerVertex,h=i._arcType,C=i._granularity,b=(i=i._ellipsoid,d.CesiumMath.chordLength(C,i.maximumRadius)),T=e.defined(f)&&!u,_=c.length,v=0;if(h===t.ArcType.GEODESIC||h===t.ArcType.RHUMB){var B,A,E=h===t.ArcType.GEODESIC?(B=d.CesiumMath.chordLength(C,i.maximumRadius),A=y.PolylinePipeline.numberOfPoints,y.PolylinePipeline.generateArc):(B=C,A=y.PolylinePipeline.numberOfPointsRhumbLine,y.PolylinePipeline.generateRhumbArc),k=y.PolylinePipeline.extractHeights(c,i),G=P;if(h===t.ArcType.GEODESIC?G.minDistance=b:G.granularity=C,G.ellipsoid=i,T){for(var w=0,D=0;D<_-1;D++)w+=A(c[D],c[D+1],B)+1;M=new Float64Array(3*w),U=new Uint8Array(4*w),G.positions=g,G.height=m;var L=0;for(D=0;D<_-1;++D){g[0]=c[D],g[1]=c[D+1],m[0]=k[D],m[1]=k[D+1];var V=E(G);if(e.defined(f))for(var x=V.length/3,S=f[D],I=0;I<x;++I)U[L++]=a.Color.floatToByte(S.red),U[L++]=a.Color.floatToByte(S.green),U[L++]=a.Color.floatToByte(S.blue),U[L++]=a.Color.floatToByte(S.alpha);M.set(V,v),v+=V.length}}else if(G.positions=c,G.height=k,M=new Float64Array(E(G)),e.defined(f)){for(U=new Uint8Array(M.length/3*4),D=0;D<_-1;++D)v=function(e,o,t,r,l,i,n){var s=y.PolylinePipeline.numberOfPoints(e,o,l),p=t.red,d=t.green,c=t.blue,f=t.alpha,u=r.red;e=r.green,o=r.blue,l=r.alpha;if(a.Color.equals(t,r)){for(m=0;m<s;m++)i[n++]=a.Color.floatToByte(p),i[n++]=a.Color.floatToByte(d),i[n++]=a.Color.floatToByte(c),i[n++]=a.Color.floatToByte(f);return n}for(var h=(u-p)/s,C=(e-d)/s,b=(o-c)/s,T=(l-f)/s,g=n,m=0;m<s;m++)i[g++]=a.Color.floatToByte(p+m*h),i[g++]=a.Color.floatToByte(d+m*C),i[g++]=a.Color.floatToByte(c+m*b),i[g++]=a.Color.floatToByte(f+m*T);return g}(c[D],c[D+1],f[D],f[D+1],b,U,v);var R=f[_-1];U[v++]=a.Color.floatToByte(R.red),U[v++]=a.Color.floatToByte(R.green),U[v++]=a.Color.floatToByte(R.blue),U[v++]=a.Color.floatToByte(R.alpha)}}else{var O=T?2*_-2:_,M=new Float64Array(3*O),U=e.defined(f)?new Uint8Array(4*O):void 0,N=0,F=0;for(D=0;D<_;++D){var H=c[D];if(T&&0<D&&(o.Cartesian3.pack(H,M,N),N+=3,S=f[D-1],U[F++]=a.Color.floatToByte(S.red),U[F++]=a.Color.floatToByte(S.green),U[F++]=a.Color.floatToByte(S.blue),U[F++]=a.Color.floatToByte(S.alpha)),T&&D===_-1)break;o.Cartesian3.pack(H,M,N),N+=3,e.defined(f)&&(S=f[D],U[F++]=a.Color.floatToByte(S.red),U[F++]=a.Color.floatToByte(S.green),U[F++]=a.Color.floatToByte(S.blue),U[F++]=a.Color.floatToByte(S.alpha))}}(R=new s.GeometryAttributes).position=new n.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:M}),e.defined(f)&&(R.color=new n.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:U,normalize:!0})),O=M.length/3;var W=p.IndexDatatype.createTypedArray(O,2*(O-1)),Y=0;for(D=0;D<O-1;++D)W[Y++]=D,W[Y++]=D+1;return new n.Geometry({attributes:R,indices:W,primitiveType:n.PrimitiveType.LINES,boundingSphere:r.BoundingSphere.fromPoints(c)})},function(t,r){return(t=e.defined(r)?T.unpack(t,r):t)._ellipsoid=o.Ellipsoid.clone(t._ellipsoid),T.createGeometry(t)}}));